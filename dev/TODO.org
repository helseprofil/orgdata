#+TITLE: TODO list
** R functions
*** DONE Input in =find_column_multi_input=
The loop refers to the variable with =NA=. Should use =seq_len(length(inVar))=.
*** DONE Seperate with whitespace
Check if =is_separate= works correctly when there is whitespace eg. ~3 = AGE~.
*** HOLD Error for MANHEADER
This is not relevant after update input style
Should give error message when MANHEADER isn't balance eg. ~3,5=AGE~
*** DONE MANHEADER input style
Should use the same style as in KOLNAVN when there are more then one columns ie.
~5=EDU,6=GEO~ instead of ~5,6=EDU,GEO~
*** DONE Read files
All files must be standardized to =data.table= class before merging.
*** DONE Use =verbose=
Implement in options ~verbose=FALSE~ for log and processes
*** DONE Close connection
=KHelse$db_close()= when =read_raw()= ends
*** DONE =csv= output
Use argument ~csv=TRUE~ in =read_raw=. File output should not be dated
*** DONE Debuging
Function =is_debug()= for debugging with =options("orgdata.debug")=
*** TODO Log
Consider R6 class.
- Process
  + Get info from table =tbl_Kode=
  + Compare oldvar agaist newvar
- public fields:
  + koblid
  + lesid
  + dt
  + group
  + variable
  + oldvar
  + newvar
  + freq
  + status
- public methods:
  + aggregate()
  + is_equal()

*** TODO tryCatch
Use =tryCatch= in loop files for error message
*** DONE Process files
Make seperate function =is_org_process=
*** TODO Recoded variables
- Not sure what I was thinking here :-(
- Make function ~check_code(x=all)~ eg. ~check_code(x=landbak)~ only check recoded value for =landbak=.
*** DONE Recode common variable
- Use group =ALL= to recode variables that are applicable to all groups. But it
should be deactivated if specification for the same columns is found in the
specific FILGRUPPE
- Let LESID empty or missing if common recoding values are within the group.
  This is weighted more than the =ALL= option.
*** DONE lesfil
arg for =file= needs more info ie. either FILID or "full path"
*** DONE .fhi extention
SSB uses extention =.fhi= for a =.csv= files. Need to add in =find_data=.
*** STRT Keep GEO as string
When reading raw data, columns with digits converted to integer including GEO.
Problem happens with splitted geocodes such as file =.fhi= from SSB. When
merging then the leading zero is missing.
*** HOLD NEXT Implicit NULL
Create category that are missing due to NULL based on the standard categories of the whole period. Steps:
- Identify class type of all columns in the dataset
- Find columns to be checked for implicit NULL
- Find the valid categories for these columns eg. age or educations levels for
  the whole period eg. 2016 to 2021
- Create the reference categories from this
- Find if any of the specific period has missing categories compared to the reference categories
- Create the new missing category with value 0 and and geo 99999999
- Find the maximum number of categories of the other variables than the specifically selected columns
- This will be the base for row number to the implicit null dataset
- Create dataset for all the implicit NULL and merge to the original dataset
- This should be implemented before aggregating to geographical levels
*** DONE TABS and VALS
- None standards columns in =tbl_innlesing= that needs to be included to output
  table. These columns will again be renamed in =tbl_Filgruppe=.
*** DONE ADDKOL
- Should read ~TAB1=DIAGNOSE, TAB2=ANTROB~ instead of ~TAB1, TAB2 = DIAGNOSE, ANTROB~ in the current style.
*** DONE ADDVAL
- Need example file to implement this column and what it's for
*** DONE LESID changed
- LESID is not unique. It should be combined with FILGRUPPE to make it a unique ID
*** TODO Change ADDKOL to KOLNAVN
- ADDKOL is renamed to KOLNAVN and all functions that used this has to be replaced with the new name.
*** TODO Create new standard columns
- Create standard columns when not available in the original rawdata by
  specifying in the respective standard columns in Access.
- eg. Column for gender isn't available but the whole dataset is for women ie.
  code =2=. In Access you can specific under =KJONN= with ~<2>~ indicating that
  standard column for =KJONN= should be created and the value is =2=.
*** TODO Compute variables
- Create a new categories in an existing column or a new columns consiting of a
  new categories from selected column.
- eg. Education has categories 1 to 5, and a new group consiting 1 and 2 is
  needed. There will then be 6 categories for education after computing ie.
  ~DT[edu %in% 1:2, edu := 6]~
- New column can also be created if needed. In Access specify ~NYKOL=JA~ and the
  code will be ~DT[, edu2 := edu ][edu %in% 1:2, edu2 := 6]~
*** TODO Replace =get= and =mget=
- For global variable that uses =get= and =mget= should use standard data.table
  =env= to define global variables.
** Access DB
*** DONE Warning duplicate filename
Give warning when filename is duplicated in Access register database under =tbl_Orgfile=
*** DONE Access original files
Should be a table with files id and dates can be deactivated at once. Steps:
- Relationship should be 1 in tbl_Orgfile to many in tbl_Koble
- Update query for koblid and filename
- Update sub_frm_qrKoble in frm_Overview
*** DONE Add TABS and VAL
- Use VALS 1 to 3 for value columns or columns that have quantity
- Use TABS 1 to 3 for category variable that aren't standard columns.
*** DONE raw-khelse_FE.accdb
- Edited version for Frontend. Replace standard =raw-khelse.accdb=
*** DONE Delete VALKOL and NAVAL
- These columns is not needed
*** DONE Rename KOLNAVN to KOLNAVN
- More intuitive what the column is for
